useDynLib(VariantAnnotation, .registration=TRUE)

import(methods)

import(BiocGenerics)

import(Rsamtools)

import(GenomicRanges)

import(zlibbioc)

importClassesFrom(Biobase, 
    AssayData
)

importFrom(Biobase,
    sampleNames, "sampleNames<-", samples
)

importClassesFrom(AnnotationDbi, 
    AnnotationDb
)

importMethodsFrom(AnnotationDbi, 
    colnames, columns, exists, keys, ncol, 
    nrow, select
)

importFrom(GenomicFeatures, 
    extractTranscriptsFromGenome
)

importClassesFrom(GenomicFeatures, 
    TranscriptDb
)

importMethodsFrom(GenomicFeatures, 
    cdsBy, exons, transcripts,
    fiveUTRsByTranscript, threeUTRsByTranscript,
    isActiveSeq, "isActiveSeq<-",
    distance
)

importFrom(IRanges, 
    CharacterList, DataFrame, DataFrameList, FilterRules, IntegerList, 
    IRanges, isSingleNumber, isSingleString, isTRUEorFALSE, LogicalList, 
    NumericList, PartitioningByEnd, PartitioningByWidth, seqsplit,
    SimpleList, splitAsList, successiveViews, FilterMatrix,
    isSingleNumberOrNA, endoapply
)

importClassesFrom(IRanges, 
    CharacterList, DataFrame, Ranges, RangesList, RangedData,
    SimpleDataFrameList, SimpleList, FilterRules, FilterMatrix
)

importMethodsFrom(IRanges, 
    "%in%", append, as.matrix, as.vector,
    countOverlaps, elementLengths, end, eval, findOverlaps, 
    follow, gsub, lapply, match, "metadata<-", narrow, order, 
    precede, queryHits, rev, Rle, runValue, sapply, shift,
    split, start, "start<-", subjectHits, substring, 
    unlist, values, "values<-", which, width, 
    expand, ifelse, as.factor
)

importFrom(XVector, "subseq", "subseq<-")

importFrom(Biostrings,
    AAStringSet, DNAStringSet, DNAStringSetList
)

importMethodsFrom(Biostrings,
    nchar, reverseComplement, substr, translate
)

importClassesFrom(Biostrings, 
    DNAStringSet, DNAStringSetList
)

importMethodsFrom(DBI, 
    dbCommit, dbConnect, dbDisconnect, dbExistsTable, 
    dbGetQuery, dbReadTable, dbWriteTable, dbListTables, 
    dbListFields
)

importClassesFrom(BSgenome, 
    BSgenome
)

importFrom(rtracklayer,
    liftOver
)

importFrom(utils, 
    txtProgressBar, setTxtProgressBar
)

exportClassPattern("^.*$")

export(
    dbSNPFilter, regionFilter, ## Defunct
    VCF, VCFHeader, reference, 
    header, "header<-", meta, "meta<-",
    vcfWhich, "vcfWhich<-", vcfFixed, "vcfFixed<-", vcfInfo, "vcfInfo<-", 
    vcfGeno, "vcfGeno<-", vcfSamples, "vcfSamples<-", vcfTrimEmpty,
    "vcfTrimEmpty<-", 
    duplicateRSID, CodingVariants, IntronVariants,
    FiveUTRVariants, ThreeUTRVariants, IntergenicVariants,
    SpliceSiteVariants, PromoterVariants, AllVariants,
    upstream, "upstream<-", downstream, "downstream<-",
    promoter, "promoter<-", intergenic, "intergenic<-",
    probabilityToSnpMatrix, GLtoGP,
    VRanges, VRangesList, asVCF, softFilter, resetFilter,
    totalDepth, altDepth, refDepth, sampleNames, "sampleNames<-", altFraction,
    softFilterMatrix, "softFilterMatrix<-", hardFilters, "hardFilters<-",
    called, stackSamples, "altDepth<-", "refDepth<-", "totalDepth<-", isIndel,
    probabilityToSnpMatrix, GLtoGP,
    readInfo, readGeno, readGT,
    tabulate
)

exportMethods(
    filterVcf, scanVcf, scanVcfHeader, ScanVcfParam,
    readVcf, readVcfLongForm, writeVcf, expand,
    predictCoding, getTranscriptSeqs, refLocsToLocalLocs, 
    MatrixToSnpMatrix, genotypeToSnpMatrix, snpSummary,
    locateVariants, summarizeVariants,

    fixed, "fixed<-", ref, "ref<-", alt, "alt<-", qual, "qual<-",
    filt, "filt<-", info, "info<-", geno, "geno<-", strand, 
    "strand<-", "[", "[<-", cbind, rbind, "mcols<-", 

    genome, seqlevels,

    reference, samples, header, meta,

    keys, columns, select
)
